FUNCTION PIOGETTABLE2COL,NAME,IMOUNIT

PIOLibIDLSO=shared_lib_path('PIOLibIDL.so')

TEMPNAME=BYTARR(128)
TEMPNAME1=TEMPNAME
TEMPNAME2=TEMPNAME
TEMPNAME3=TEMPNAME
TEMPNAME4=TEMPNAME
TEMPNAME5=TEMPNAME
TEMPNAME6=TEMPNAME
SZ0=LONG64(0)
SZ1=LONG64(0)
SZ2=LONG64(0)
SZ3=LONG64(0)
SZ4=LONG64(0)
SZ5=LONG64(0)
SZ6=LONG64(0)

ERR = LONG64(0)
NBPOINT= LONG64(0)
TABLEUNIT= LONG64(0)

ERR = call_external(PIOLibIDLSO,'piogettable2col_tempoidl', $
              LONG64(NBPOINT),TEMPNAME,TEMPNAME1,TEMPNAME2, $
              TEMPNAME3,TEMPNAME4,TEMPNAME5,TEMPNAME6,TABLEUNIT, $
              PIOSTRING2C(NAME),LONG64(IMOUNIT), $
              SZ0,SZ1,SZ2,SZ3,SZ4,SZ5,SZ6,/L64_VALUE)
PIOERRMESS,ERR

TYPE =STRMID(STRING(TEMPNAME5),0,SZ5)
CASE (STRING(TYPE)) OF
        "PIOLONG": BEGIN
            X=LONG64(0)
            DATAX = LON64ARR(NBPOINT)
            END
        "PIOBYTE": BEGIN
            X=BYTE(0)
            DATAX = BYTARR(NBPOINT)
            END
        "PIOSHORT": BEGIN
            X=0
            DATAX = INTARR(NBPOINT)
            END
        "PIOFLOAT": BEGIN
            X=FLOAT(0)
            DATAX = FLTARR(NBPOINT)
            END
        "PIODOUBLE": BEGIN
            X=DOUBLE(0)
            DATAX = DBLARR(NBPOINT)
            END
        "PIOCOMPLEX": BEGIN
            X=COMPLEX(0,0)
            DATAX = COMPLEXARR(NBPOINT)
            END
        "PIODBLCOMPLEX": BEGIN
            X=DCOMPLEX(0,0)
            DATAX = DCOMPLEXARR(NBPOINT)
            END
        ELSE: return,0
    END
TYPE =STRMID(STRING(TEMPNAME6),0,SZ6)
CASE (STRING(TYPE)) OF
        "PIOLONG": BEGIN
            Y=LONG64(0)
            DATAY = LON64ARR(NBPOINT)
            END
        "PIOBYTE": BEGIN
            Y=BYTE(0)
            DATAY = BYTARR(NBPOINT)
            END
        "PIOSHORT": BEGIN
            Y=0
            DATAY = INTARR(NBPOINT)
            END
        "PIOFLOAT": BEGIN
            Y=FLOAT(0)
            DATAY = FLTARR(NBPOINT)
            END
        "PIODOUBLE": BEGIN
            Y=DOUBLE(0)
            DATAY = DBLARR(NBPOINT)
            END
        "PIOCOMPLEX": BEGIN
            Y=COMPLEX(0,0)
            DATAY = COMPLEXARR(NBPOINT)
            END
        "PIODBLCOMPLEX": BEGIN
            Y=DCOMPLEX(0,0)
            DATAY = DCOMPLEXARR(NBPOINT)
            END
        ELSE: return,0
    END


TABLE ={NBPOINT:NBPOINT,XUNIT:'',YUNIT:'',XNAME:'',YNAME:'', $
        COMMENT:'', XTYPE:'',YTYPE:'',TABLEUNIT:LONG64(0), $
        X:DATAX,DX:DATAX,Y:DATAY,DY:DATAY}

TABLE.XUNIT = STRMID(STRING(TEMPNAME),0,SZ0)
TABLE.YUNIT = STRMID(STRING(TEMPNAME1),0,SZ1)
TABLE.XNAME =STRMID(STRING(TEMPNAME2),0,SZ2)
TABLE.YNAME =STRMID(STRING(TEMPNAME3),0,SZ3)
TABLE.COMMENT =STRMID(STRING(TEMPNAME4),0,SZ4)
TABLE.XTYPE =TYPE
TABLE.YTYPE =TYPE
for i=0,NBPOINT-1 do begin
    DX=X
    DY=Y
    err = call_external(PIOLibIDLSO,'pioextracttable2col_tempoidl', $
                        X,DX,Y,DY,PIOSTRING2C(TABLE.XTYPE),LONG64(i), $
                              LONG64(TABLEUNIT))
    PIOERRMESS,ERR
    TABLE.X(I)=X
    TABLE.DX(I)=DX
    TABLE.Y(I)=Y
    TABLE.DY(I)=DY
end

; Free memory allocated for table

PIOERRMESS,call_external(PIOLibIDLSO,'piodeletetable2col_tempoidl', $
                        LONG64(TABLEUNIT))
RETURN,TABLE
END
